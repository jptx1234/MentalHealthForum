<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>版块 - 南阳理工心理健康论坛</title>
		<link rel="stylesheet" href="css/bootstrap.css" />
		<link rel="stylesheet" href="css/summernote.css" />
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/board.css" />
		<link rel="stylesheet" href="css/index.css" />
		<link rel="stylesheet" href="css/post.css" />
		<script type="text/javascript" src="js/jquery-2.2.4.min.js"></script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/summernote.min.js"></script>
		<script type="text/javascript" src="js/summernote-zh-CN.min.js"></script>
		<script type="text/javascript" src="js/loadNavAndFooter.js" ></script>
		<script type="text/javascript" src="js/common.js" ></script>
	</head>

	<body>
		<script type="text/javascript">
			if(getParameterByName("id") == null){
				window.location.href="index.html";
			}
		</script>
	<main id="main">
		<div class="center-block post-list">
			<ol class="breadcrumb">
				<li>
					<a href="#">首页</a>
				</li>
				<li>
					<a href="#">求助区</a>
				</li>
				<li class="active">求助老师</li>
			</ol>
			<div class="panel panel-default">
				<div class="panel-heading">
					<div class="panel-title post-list-title">
						求助老师
						<button id="edit-new-post-button" type="button" class="btn btn-primary" style="float: right;width: 100px; ">
							发帖
						</button>
					</div>
				</div>
				<div id="post-list-div">
					
					<table class="table " id="topic-list-table">
						<tr id="list-title">
							<th>帖子</th>
							<th>回复数</th>
							<th>发帖时间</th>
							<th>作者</th>
						</tr>
						<tr style="display: none;" id="topic-row-model">
							<td><a href="#" content="topic-title"></a></td>
							<td> <span class="badge " content="topic-replies-count"></span></td>
							<td content="topic-time"></td>
							<td content="topic-author"></td>
						</tr>
					</table>
				</div>
				<div id="new-post-div" style="display: none; padding: 6px;">
					<form action="#" novalidate>
						<div class="form-group">
							<label for="new-post-title">标题</label>
							<input type="text" class="form-control" name="title" id="new-post-title" placeholder="请输入帖子标题 "/>
						</div>
						<div class="form-group ">
							<label for="new-post">帖子内容</label>
							<textarea id="new-post" name="content" class="summernote"></textarea>
						</div>
					</form>
					<button type="button" id="new-post-submit" class="btn btn-primary btn-lg btn-block">发帖</button>
			</div>
			</div>
			<nav class="bottom-page" style="text-align: center; ">
				<ul class="pagination ">
					<li>
						<a href="# ">&laquo;</a>
					</li>
					<li class="active ">
						<a href="# ">1</a>
					</li>
					<li>
						<a href="# ">2</a>
					</li>
					<li>
						<a href="# ">3</a>
					</li>
					<li>
						<a href="# ">4</a>
					</li>
					<li>
						<a href="# ">5</a>
					</li>
					<li>
						<a href="# ">&raquo;</a>
					</li>
				</ul>
			</nav>
			
		</div>
		<script type="text/javascript" src="js/loadSummernote.js" ></script>
		<script type="text/javascript">
			$("#edit-new-post-button").click(function() {
					var btn = $(this);
					if(($.trim(btn.text())) == "发帖"){
						btn.text("取消发帖");
						btn.removeClass("btn-primary");
						btn.addClass("btn-danger");
						$("#post-list-div").fadeOut(function(){
							$("#new-post-div").fadeIn();
							$("#new-post-title").focus();
						});
						$(".bottom-page").hide();
					}else{
						btn.text("发帖");
						btn.removeClass("btn-danger");
						btn.addClass("btn-primary");
						$("#new-post-div").fadeOut(function(){
							$("#post-list-div").fadeIn();
						});
						btn.blur();
						$(".bottom-page").show();
					}
				});
				$("#new-post-submit").click(function(){
					var markupStr = $('#new-post').summernote('code');
					console.log(markupStr);
				});
				$(function(){
					var boardId = getParameterByName("id");
					$.get("topic_listTopicsOfBoard",{"board.id":boardId},function(data){
						for(var i=0;i<data.rows.length;i++){
							var topic = data.rows[i];
							var model = $("#topic-row-model").clone();
							model.attr("id","topic-"+topic.id);
							model.appendTo($("#topic-list-table"));
							model.find("[content='topic-title']").text(topic.title);
							model.find("[content='topic-title']").attr("href","topic.html?id="+topic.id);
							model.find("[content='topic-replies-count']").text(topic.repliesCount);
							model.find("[content='topic-time']").text(topic.time);
							model.find("[content='topic-author']").text(topic.user.username);
							model.fadeIn();
						}
					});
				});
		</script>
	</main>
	</body>
</html>